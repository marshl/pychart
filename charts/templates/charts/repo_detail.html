{% extends 'charts/base.html' %}

{% block content %}
<script type="application/javascript">
$(document).ready(function() {
    // Load the Visualization API and the piechart package.
    google.charts.load('current', {'packages':['corechart']});

    // Set a callback to run when the Google Visualization API is loaded.
    google.charts.setOnLoadCallback(loadChart);

    function loadChart() {
      var jsonData = $.ajax({
          url: "get_repo_author_total",
          dataType: "json",
          async: true,
          success: drawChart
          }).responseText;

    }

    function drawChart(jsonData) {
      // Create our data table out of JSON data loaded from server.
      var data = new google.visualization.DataTable(jsonData);

     var options = {
       title: 'Authors',
       is3D: true,
       width: 900,
       height: 500,
     };


      // Instantiate and draw our chart, passing in some options.
      var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
      chart.draw(data, options);
    }
});


</script>

<div class="repo">
    <div class="date">Date:
        {{ repo.created_date}}
    </div>
    <h1>{{ repo.title }}</h1>
    <p>{{ repo.path }}</p>
    <a href="{% url 'repo_reload' pk=repo.pk %}">Load Commits</a>
    <a href="{% url 'repo_reset' pk=repo.pk %}">Reset Commits</a>
</div>

<div id="chart_div"></div>

{% endblock %}
